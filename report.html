<!DOCTYPE html>
<html lang="th">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>‡πÉ‡∏ö‡∏™‡∏±‡πà‡∏á‡∏á‡∏≤‡∏ô / ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô</title>

<!-- PDF Export -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>

<!-- Firebase -->
<script type="module" src="https://www.gstatic.com/firebasejs/12.3.0/firebase-app.js"></script>
<script type="module" src="https://www.gstatic.com/firebasejs/12.3.0/firebase-firestore.js"></script>

<style>
body { font-family: "TH Sarabun New", sans-serif; background: #f8fafc; margin:0; font-size:14px; }
.header-bar { display:flex; justify-content:space-between; align-items:center; background:linear-gradient(90deg,#c82a11,#ff0101); color:#fff; padding:12px 20px; }
.header-bar h1 { margin:0; font-size:16px; font-weight:600; }
.header-bar button { background:rgba(255,255,255,0.15); color:#fff; border:1px solid rgba(255,255,255,0.3); border-radius:8px; padding:6px 12px; cursor:pointer; }
.header-bar button:hover { background:rgba(255,255,255,0.25); }

.btn-group { display:flex; justify-content:center; gap:10px; margin:10px 0; align-items:center; }
.btn { background:#ff0101; color:#fff; border:none; padding:8px 14px; border-radius:8px; cursor:pointer; font-size:14px; font-weight:600; transition:0.2s; }
.btn:hover { background:#c82a11; }
.btn.secondary { background:#64748b; }
.btn.secondary:hover { background:#475569; }

.container { width:210mm; min-height:297mm; background:#fff; margin:10px auto; padding:18mm; box-shadow:0 6px 20px rgba(0,0,0,0.08); border-radius:12px; box-sizing:border-box; }

.header-title { text-align:center; margin-bottom:10px; }
.header-title h2 { margin:0; text-decoration:underline; font-weight:700; font-size:18px; }
.header-title .jobno { text-align:right; font-size:14px; margin-top:4px; }

.line { border-bottom:1px dotted #000; display:inline-block; min-width:35mm; padding-bottom:1px; text-align:center; }
.lines { border-bottom:1px dotted #000; display:inline-block; min-width:35mm; padding-bottom:1px; text-align:center; }
.line2 { border-bottom:1px dotted #000; display:inline-block; min-width:55mm; padding-bottom:1px; text-align:center; }
.line3 { border-bottom:1px dotted #000; display:inline-block; min-width:138mm; padding-bottom:1px; text-align:center; }
.line4 { border-bottom:1px dotted #000; display:inline-block; min-width:60mm; padding-bottom:1px; text-align:center; }
.line5 { border-bottom:1px dotted #000; display:inline-block; min-width:125mm; padding-bottom:1px; text-align:center; }
.line6 { border-bottom:1px dotted #000; display:inline-block; min-width:180mm; padding-bottom:1px; text-align:center; }
.section { margin-top:6mm; line-height:1.5; }
textarea { width:100%; border:none; border-bottom:1px dotted #000; resize:none; font-size:14px; background:transparent; padding:3px 0; }
input[type="checkbox"] { transform:scale(1.1); margin-right:3px; }
.signature { margin-top:18mm; display:flex; justify-content:space-between; }
.signature div { text-align:center; width:45%; font-size:14px; }
input[type="text"] { padding:8px 12px; font-size:14px; border:1px solid #ddd; border-radius:6px; width:200px; }
.search-box { display:flex; gap:10px; align-items:center; }
</style>
</head>

<body>

<div class="header-bar">
  <h1>üìÑ ‡πÉ‡∏ö‡∏™‡∏±‡πà‡∏á‡∏á‡∏≤‡∏ô / ‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô</h1>
  <button onclick="window.location.href='notchoose.html'">‚¨Ö ‡∏Å‡∏•‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏£‡∏Å</button>
</div>

<div class="btn-group">
  <div class="search-box">
    <label>Job Number:</label>
    <input type="text" id="jobNumberInput" placeholder="‡∏Å‡∏£‡∏≠‡∏Å Job Number...">
    <button class="btn secondary" id="searchBtn">üîç ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤</button>
  </div>
  <button class="btn" id="printBtn">üñ®Ô∏è ‡∏õ‡∏£‡∏¥‡πâ‡∏ô PDF</button>
</div>

<div id="report" class="container">

  <!-- üîπ ‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠ + ‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á‡∏á‡∏≤‡∏ô -->
  <div class="header-title">
    <h2>‡πÉ‡∏ö‡∏™‡∏±‡πà‡∏á‡∏á‡∏≤‡∏ô / ‡πÉ‡∏ö‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô</h2>
    <div class="jobno">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà: <span id="jobNo" class="line"></span></div>
  </div>

  <div class="section">
    ‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏™‡∏±‡πà‡∏á‡∏á‡∏≤‡∏ô: <span id="assignedBy" class="line"></span>
    ‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á‡∏á‡∏≤‡∏ô: <span id="orderDate" class="line"></span>
    ‡∏Å‡∏≥‡∏´‡∏ô‡∏î‡πÄ‡∏™‡∏£‡πá‡∏à‡∏á‡∏≤‡∏ô: <span id="deadlines" class="line"></span><br>
  </div>

  <div class="section">
    ‡∏•‡∏±‡∏Å‡∏©‡∏ì‡∏∞‡∏á‡∏≤‡∏ô:
    <div style="text-align: right;">‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà JOB: <span id="docNo" class="line"></span></div>
    <label><input type="checkbox" id="type1"> ‡∏™‡πà‡∏á‡∏°‡∏≠‡∏ö</label>
    <label><input type="checkbox" id="type2"> ‡∏ù‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏°</label>
    <label><input type="checkbox" id="type3"> ‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Å/‡∏ã‡πà‡∏≠‡∏°</label>
    <label><input type="checkbox" id="type4"> Visit</label>
    <label><input type="checkbox" id="type5"> ‡∏≠‡∏∑‡πà‡∏ô ‡πÜ</label>
  </div>

  <div class="section">
    ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏á‡∏≤‡∏ô: <span id="details" class="line5"></span><br><br>
  </div>

  <div class="section">
    ‡∏≠‡∏≠‡∏Å‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: <span id="date" class="line2"></span>
    ‡πÄ‡∏î‡∏¥‡∏ô‡∏ó‡∏≤‡∏á‡∏Å‡∏•‡∏±‡∏ö‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà: <span id="deadline" class="line2"></span>
  </div>

  <div class="section">
    ‡∏™‡∏ñ‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô: <span id="location" class="line3"></span>
  </div>

  <div class="section">
    ‡∏ú‡∏π‡πâ‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠: <span id="contactName" class="line4"></span>
    ‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå: <span id="contactPhone" class="line4"></span>
  </div>

  <div class="section">
    ‡∏ú‡∏π‡πâ‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô: <span id="title" class="line3"></span>
  </div>

  <div>
    <br><br>---------------------------------------------------------------------------------------------------------------------------------------------
  </div>

  <div class="section">
    ‡∏™‡∏£‡∏∏‡∏õ‡∏ú‡∏•‡∏Å‡∏≤‡∏£‡∏õ‡∏è‡∏¥‡∏ö‡∏±‡∏ï‡∏¥‡∏á‡∏≤‡∏ô:<br>
    <label><input type="checkbox" id="success"> ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢</label>
    <label><input type="checkbox" id="fail"> ‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢</label>
    <span id="incompleteReason" class="line5"></span><br><br>
    ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏´‡∏ï‡∏∏: <span id="note" class="line5"></span>
  </div>

  <div class="signature">
    <div>
      <br><br><br>(..........................................)<br><br><br>
      ‡∏•‡∏á‡∏ä‡∏∑‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö‡∏á‡∏≤‡∏ô
    </div>
    <div>
      <img id="signatureImg" 
           src="https://i.postimg.cc/Ny0GLn2m/signature.png" 
           style="height:50px; display:none; margin:0 auto;">
      (..........................................)<br><br><br>
      ‡∏ú‡∏π‡πâ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥ / ‡∏ú‡∏π‡πâ‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£
    </div>
  </div>
  <div class="signature">
      <u>‡∏™‡∏≥‡∏Ñ‡∏±‡∏ç!</u> ‡∏Å‡∏≤‡∏£‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£<br>
           &nbsp;&nbsp;1. ‡∏™‡πà‡∏á‡∏°‡∏≠‡∏ö‡∏á‡∏≤‡∏ô ‡πÅ‡∏•‡∏∞‡∏ï‡∏¥‡∏î‡∏ï‡∏±‡πâ‡∏á‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 7 ‡∏ß‡∏±‡∏ô ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£<br>
           &nbsp;&nbsp;2. ‡∏ù‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏°‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 5 ‡∏ß‡∏±‡∏ô ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£<br>
           &nbsp;&nbsp;3. ‡∏≠‡∏≠‡∏Å‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 10 ‡∏ß‡∏±‡∏ô ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£<br>
           &nbsp;&nbsp;4. ‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ/‡∏ã‡πà‡∏≠‡∏° ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 3 ‡∏ß‡∏±‡∏ô‡∏ó‡∏≥‡∏Å‡∏≤‡∏£<br>
           &nbsp;&nbsp;5. Visit ‡∏á‡∏≤‡∏ô ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏ô‡πâ‡∏≠‡∏¢ 5 ‡∏ß‡∏±‡∏ô ‡∏ó‡∏≥‡∏Å‡∏≤‡∏£<br>
      <div>
        ‡∏Å‡∏£‡∏ì‡∏µ‡∏î‡πà‡∏ß‡∏ô!<br><br><br><br>
        ............................................<br><br>
        ‡∏ú‡∏π‡πâ‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥/‡∏Ñ‡∏∏‡∏ì‡∏â‡∏±‡∏ï‡∏£‡∏ä‡∏±‡∏¢
      </div>
    </div>

</div>

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-app.js";
import { getFirestore, collection, query, where, getDocs } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-firestore.js";

// Firebase Config
const firebaseConfig = {
  apiKey: "AIzaSyAXayBBLVSohNCIsnlWRq6rD0BUbW70MGk",
  authDomain: "events-666d6.firebaseapp.com",
  projectId: "events-666d6",
  storageBucket: "events-666d6.appspot.com",
  messagingSenderId: "589078390914",
  appId: "1:589078390914:web:480ce96137ffac835aac9b",
  measurementId: "G-97GD75S814"
};

const app = initializeApp(firebaseConfig);
const db = getFirestore(app);

const jobNumberInput = document.getElementById("jobNumberInput");
const searchBtn = document.getElementById("searchBtn");
const signatureImg = document.getElementById("signatureImg");

// ‡∏î‡∏∂‡∏á‡∏Ñ‡πà‡∏≤‡∏à‡∏≤‡∏Å URL parameters ‡∏ó‡∏µ‡πà‡∏™‡πà‡∏á‡∏°‡∏≤‡∏à‡∏≤‡∏Å manageS.html
function getParamsFromURL() {
  const urlParams = new URLSearchParams(window.location.search);
  return {
    jobNumber: urlParams.get('job'),      // ‚úÖ ‡∏£‡∏±‡∏ö‡∏à‡∏≤‡∏Å ?job=
    start: urlParams.get('start'),         // ‚úÖ ‡∏£‡∏±‡∏ö‡∏à‡∏≤‡∏Å &start=
    end: urlParams.get('end')             // ‚úÖ ‡∏£‡∏±‡∏ö‡∏à‡∏≤‡∏Å &end=
  };
}

// ‡∏ü‡∏±‡∏á‡∏Å‡πå‡∏ä‡∏±‡∏ô‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡πÅ‡∏•‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•
async function searchAndDisplay(jobNum = null) {
  const jobNumber = jobNum || jobNumberInput.value.trim();
  
  if (!jobNumber) {
    alert("‚ö†Ô∏è ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å Job Number");
    return;
  }

  try {
    // ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏à‡∏≤‡∏Å Firebase ‡∏ó‡∏µ‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ö jobNumber
    const q = query(collection(db, "events"), where("jobNumber", "==", jobNumber));
    const querySnapshot = await getDocs(q);

    if (querySnapshot.empty) {
      alert("‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Job Number: " + jobNumber);
      return;
    }

    // ‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ä‡∏∏‡∏î‡πÅ‡∏£‡∏Å‡∏ó‡∏µ‡πà‡∏û‡∏ö
    const data = querySnapshot.docs[0].data();

    // ‡∏•‡∏≤‡∏¢‡πÄ‡∏ã‡πá‡∏ô
    signatureImg.style.display = (data.status === "‡∏≠‡∏ô‡∏∏‡∏°‡∏±‡∏ï‡∏¥" || data.status === "‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢" || data.status === "‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢") ? "block" : "none";

    // ‡πÉ‡∏™‡πà‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÉ‡∏ô‡∏ü‡∏≠‡∏£‡πå‡∏° (‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏à‡∏∞‡∏≠‡∏¢‡∏π‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏•‡∏≤‡∏á‡πÄ‡∏™‡πâ‡∏ô‡∏õ‡∏£‡∏∞)
    document.getElementById("docNo").textContent = data.jobNumber || "";
    document.getElementById("jobNo").textContent = data.job || "";
    document.getElementById("assignedBy").textContent = (data.assigners || []).join(", ");
    document.getElementById("date").textContent = data.start || "";
    document.getElementById("orderDate").textContent = data.orderDate || "";
    document.getElementById("deadline").textContent = data.end || "";
    document.getElementById("deadlines").textContent = data.end || "";
    document.getElementById("details").textContent = data.details || "";
    document.getElementById("location").textContent = data.location || "";
    document.getElementById("title").textContent = (data.workers || []).join(", ");
    document.getElementById("contactName").textContent = data.contactPerson || "-";
    document.getElementById("contactPhone").textContent = data.phoneNumber || "-";

    // Reset checkboxes
    ["type1","type2","type3","type4","type5"].forEach(id => document.getElementById(id).checked=false);

    // ‡πÄ‡∏ä‡πá‡∏Ñ jobTypes
    if (data.jobTypes) {
      if (data.jobTypes.includes("‡∏™‡πà‡∏á‡∏°‡∏≠‡∏ö")) document.getElementById("type1").checked = true;
      if (data.jobTypes.includes("‡∏ù‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏°")) document.getElementById("type2").checked = true;
      if (data.jobTypes.includes("‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ/‡∏ã‡πà‡∏≠‡∏°")) document.getElementById("type3").checked = true;
      if (data.jobTypes.includes("Visit")) document.getElementById("type4").checked = true;

      const other = data.jobTypes.find(t =>
        !["‡∏™‡πà‡∏á‡∏°‡∏≠‡∏ö","‡∏ù‡∏∂‡∏Å‡∏≠‡∏ö‡∏£‡∏°","‡∏ï‡∏£‡∏ß‡∏à‡πÄ‡∏ä‡πá‡∏Ñ/‡∏ã‡πà‡∏≠‡∏°","Visit"].includes(t)
      );
      if (other) document.getElementById("type5").checked = true;
    }

    document.getElementById("success").checked = data.status === "‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢";
    document.getElementById("fail").checked = data.status === "‡πÑ‡∏°‡πà‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢";
    document.getElementById("note").textContent = data.remark || "";
    document.getElementById("incompleteReason").textContent = data.incompleteReason || "";

    alert("‚úÖ ‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Job Number: " + jobNumber);

  } catch (error) {
    console.error("Error:", error);
    alert("‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î: " + error.message);
  }
}

// Event Listeners
searchBtn.addEventListener("click", () => searchAndDisplay());
jobNumberInput.addEventListener("keypress", (e) => {
  if (e.key === "Enter") searchAndDisplay();
});

// ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥‡∏ñ‡πâ‡∏≤‡∏°‡∏µ jobNumber ‡πÉ‡∏ô URL
window.addEventListener('DOMContentLoaded', () => {
  const params = getParamsFromURL();
  
  if (params.jobNumber) {
    // ‡∏Å‡∏£‡∏≠‡∏Å jobNumber ‡∏•‡∏á‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á input
    jobNumberInput.value = params.jobNumber;
    
    // ‡πÅ‡∏™‡∏î‡∏á start ‡πÅ‡∏•‡∏∞ end date ‡∏ñ‡πâ‡∏≤‡∏°‡∏µ (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö)
    if (params.start) console.log("‡∏ß‡∏±‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°:", params.start);
    if (params.end) console.log("‡∏ß‡∏±‡∏ô‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î:", params.end);
    
    // ‡∏Ñ‡πâ‡∏ô‡∏´‡∏≤‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏≠‡∏±‡∏ï‡πÇ‡∏ô‡∏°‡∏±‡∏ï‡∏¥
    searchAndDisplay(params.jobNumber);
  }
});

// ‡∏õ‡∏£‡∏¥‡πâ‡∏ô PDF
document.getElementById("printBtn").addEventListener("click", () => {
  const element = document.getElementById("report");

  html2pdf().set({
    margin: 10,
    filename: "‡πÉ‡∏ö‡∏™‡∏±‡πà‡∏á‡∏á‡∏≤‡∏ô.pdf",
    image: { type: "jpeg", quality: 1 },
    html2canvas: { scale: 2, useCORS: true },
    jsPDF: { unit: "mm", format: "a4", orientation: "portrait" }
  }).from(element).save();
});
</script>
</body>
</html>
